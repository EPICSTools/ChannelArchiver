<html>

<head>
<title>CGIExport Setup</title>
</head>

<body BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#0000FF" ALINK="#800080"
background="../blueback.jpg">
<font color="#000000" face="Comic Sans MS, Arial, Helvetica">

<blockquote>
  <h1>Channel Archive CGI Setup</h1>
  <p>Right now the path names are relative but fixed and have to be similar to the Test
  directory tree underneath the CGIExport source dir.:<ul>
    <li>ChannelArchiver/CGIExport/Tests/<br>
      HTML files for accessing the CGI Tool, must be exported via WWW server.<br>
      <br>
      When producing any output, CGIExport looks for files <em>cgi_body_start.txt</em> and <em>cgi_body_end.txt</em>.<br>
      This Test directory is prepared such that these files contain links to additional web
      pages about the &quot;Rounding&quot; feature etc.<br>
      <u>For now that is the &quot;Manual&quot; on how to use the CGI tool.</u></li>
    <li>..../Tests/cgi<br>
      The executable CGI tool must be copied in here as <b>CGIExport.cgi</b>.<br>
      Note the file extension, it's used in the WWW server configuration later on!<br>
      The WWW server must allow &quot;execute&quot; access to this directory.<br>
      (For Win32, the files Com.dll, db.dll and ca.dll from your EPICS/base/bin/WIN32 also have
      to be copied in here.)</li>
    <li>..../Tests/cgi/tmp<br>
      In here, the CGI tool creates temporary files, so you must create this directory</li>
  </ul>
  <p>Make sure that the WWW server as well as CGI programs launched by it (usually running
  as &quot;nobody&quot;) have access to those parts of the file system, especially check
  write access to ...../cgi/tmp ! </p>
  <p>In addition, the path to GNUPlot is hard-coded at compile time (check
  ChannelArchiver/CGIExport/Makefile.Host). One could consider this a security feature...</p>
  <p>To test the CGI tool, make the Test directory accessible by your WWW server and make
  sure that the cgi subdirectory is executable (see below for MS and Apache specifics).</p>
  <p>There are simple Perl scripts cgi/Hi.pl and cgi/env.pl to debug your WWW setup. <br>
  (You don't need perl to use the CGIExport tool. If the example perl scripts don't mean
  anything to you, don't worry.) </p>
  <p>When your WWW server setup was successful, you should be able to point your web browser
  to http://localhost/archive/Default.htm and see the initial test page. </p>
  <h2>Microsoft Personal Web Server</h2>
  <ol>
    <li>Export the Test directory as e.g. &quot;/archive&quot;,</li>
    <li>Export Test/cgi directory as &quot;/archive/cgi&quot; and make it executable</li>
    <li>Modify registry to allow perl scripts (useful for debugging, not essential for CGI
      tool): <pre>[HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W3Svc\Parameters\Script Map]
c:\sys\perl\bin\perl.exe %s %s;</pre>
    </li>
  </ol>
  <h2>Apache Web Server</h2>
  <p>Add to end of /etc/httpd/httpd.conf : </p>
  <pre>  #Added for CGIExport Test:
  #
  #Uncomment these (usually found earlier in this file)
  #if you want perl support:
  #LoadModule perl_module modules/libperl.so
  #AddModule mod_perl.c
  #
  #Note that without special settings,
  #apache does not follow symb. links,
  #so these names have to be 'real':
  Alias /archive &quot;/home/Kay/Epics/extensions/src/ChannelArchiver/CGIExport/Tests&quot;
  &lt;Directory /home/Kay/Epics/extensions/src/ChannelArchiver/CGIExport/Tests&gt;
  Order Allow,Deny
  Allow from All
  &lt;/Directory&gt;
  # Make /archive/cgi executable, allow Perl:
  # (this requires the above settings to activate mod_perl)
  AddHandler perl-script .pl
  AddHandler cgi-script .cgi

  &lt;Directory /home/Kay/Epics/extensions/src/ChannelArchiver/CGIExport/Tests/cgi&gt;
  PerlHandler Apache::Registry
  PerlSendHeader On
  Options +ExecCGI
  &lt;/Directory&gt; 
</pre>
  <p>Start/stop on Linux:<br>
  /etc/rc.d/apache {start|stop|status|restart|reload}</p>
  <p>On RedHat6.x:<br>
  /etc/rc.d/init.d/httpd {start|stop|status|restart|reload}</p>
  <p>Error Log:<br>
  cat /var/log/httpd.error_log </p>
  <hr>
  <p align="left">Requests/comments?<br>
  <a href="mailto:kasemir@lanl.gov">E-Mail: Kay-Uwe Kasemir</a></p>
</blockquote>
</font>
</body>
</html>
